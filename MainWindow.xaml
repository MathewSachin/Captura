<Fluent:RibbonWindow x:Class="Captura.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:this="clr-namespace:Captura"
        xmlns:Fluent="clr-namespace:Fluent;assembly=Fluent"
        Title="Captura" Width="525" Height="300" MinHeight="300" MinWidth="525"
        Closing="Window_Closing" Icon="Images/Captura.ico">
    <Fluent:RibbonWindow.TaskbarItemInfo>
        <TaskbarItemInfo>
            <TaskbarItemInfo.ThumbButtonInfos>
                <ThumbButtonInfo x:Name="RecordThumb"  Description="Record" Click="RecordControl_Click" ImageSource="Images/Record.png"/>
            </TaskbarItemInfo.ThumbButtonInfos>
        </TaskbarItemInfo>
    </Fluent:RibbonWindow.TaskbarItemInfo>
    <Fluent:RibbonWindow.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/Fluent;Component/Themes/Office2013/Generic.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <ControlTemplate x:Key="ImageButtonTemplate" TargetType="{x:Type Button}">
                <Grid x:Name="Grid" Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}" 
                        Width="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}">
                        <Image Margin="5" x:Name="ButtonImage" Opacity="0.6"
                        Source="{Binding Content, RelativeSource={RelativeSource TemplatedParent}}" 
                        ToolTip="{TemplateBinding ToolTip}"/>
                    </StackPanel>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver" Value="true">
                        <Setter TargetName="ButtonImage" Property="Opacity" Value="0.8" />
                    </Trigger>
                    <Trigger Property="IsPressed" Value="true">
                        <Setter TargetName="ButtonImage" Property="Opacity" Value="1" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter TargetName="ButtonImage" Property="Opacity" Value="0.3" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </ResourceDictionary>
    </Fluent:RibbonWindow.Resources>
    <DockPanel>
        <Fluent:Ribbon AutomaticStateManagement="True" DockPanel.Dock="Top">
            <Fluent:Ribbon.Menu>
                <Fluent:Backstage>
                    <Fluent:BackstageTabControl>
                        <Fluent:Button Header="Last" Command="PreviousPage"/>
                        <Fluent:BackstageTabItem Header="About" KeyTip="A">
                            <StackPanel Margin="5">
                                <Label Content="Captura" FontSize="18" Foreground="DarkBlue"/>
                                <Label Content="(c) Mathew Sachin. All Rights Reserved" 
                                               FontFamily="Comic Sans MS" FontSize="12"/>
                            </StackPanel>
                        </Fluent:BackstageTabItem>
                        <Fluent:Button Header="Exit" KeyTip="X" Command="Close"/>
                    </Fluent:BackstageTabControl>
                </Fluent:Backstage>
            </Fluent:Ribbon.Menu>

            <Fluent:RibbonTabItem Header="Home">
                <Fluent:RibbonGroupBox>
                    <StackPanel Orientation="Horizontal">
                        <Fluent:TextBox Header="Output Directory" x:Name="OutPath" Width="300" IsReadOnly="True"/>
                        <Button Content="..." Width="25" Background="White" Command="Open" />
                    </StackPanel>
                    <Fluent:ToggleButton Icon="Images/Minimize.ico" Size="Middle" Margin="0,5" IsEnabled="{Binding ReadyToRecord}"
                                         Header="Minimise On Capture Start" x:Name="MinOnStart" IsChecked="True"/>
                    <Fluent:Button Margin="5,0" Header="Refresh" Command="Refresh" Size="Middle" Icon="Images/Refresh.ico"/>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <Fluent:RibbonTabItem Header="Video">
                <Fluent:RibbonGroupBox>
                    <Fluent:Spinner Header="Frame Rate" IsEnabled="{Binding ReadyToRecord}" x:Name="FrameRate" Value="10" Minimum="1" Maximum="30"/>
                    <Fluent:Spinner Minimum="1" Maximum="100" IsEnabled="{Binding ReadyToRecord}" Header="Quality" Value="70" Name="Quality"/>
                    <Fluent:ToggleButton Header="Include Cursor" Size="Large" LargeIcon="Images/Cursor.ico" IsEnabled="{Binding ReadyToRecord}"
                                         Icon="Images/Cursor.ico" Margin="3,0" x:Name="IncludeCursor"/>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Header="Encoder">
                    <Fluent:InRibbonGallery MaxItemsInRow="1" MaxItemsInDropDownRow="1" Width="200" ItemWidth="200" ItemsSource="{Binding AvailableCodecs}"
                                  SelectedValuePath="Codec" IsEnabled="{Binding ReadyToRecord}"
                                  DisplayMemberPath="Name"
                                  SelectedValue="{Binding Encoder, Mode=TwoWay}"/>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <Fluent:RibbonTabItem Header="Window">
                <Fluent:RibbonGroupBox>
                    <Fluent:InRibbonGallery MaxItemsInRow="1" MaxItemsInDropDownRow="1" Width="500" ItemWidth="500" ItemsSource="{Binding AvailableWindows}"
                                  IsEnabled="{Binding ReadyToRecord}"
                                  DisplayMemberPath="Title"
                                  SelectedValue="{Binding SelectedWindow, Mode=TwoWay}"/>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <Fluent:RibbonTabItem Header="Audio">
                <Fluent:RibbonGroupBox Header="Devices">
                    <Fluent:InRibbonGallery MaxItemsInRow="1" MaxItemsInDropDownRow="1" Width="330" ItemWidth="330" ItemsSource="{Binding AvailableAudioSources}"
                                  DisplayMemberPath="Value" IsEnabled="{Binding ReadyToRecord}"
                                  SelectedValuePath="Key" SelectedValue="{Binding SelectedAudioSourceIndex, Mode=TwoWay}"/>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox>
                    <Fluent:ToggleButton Header="Stereo" Size="Middle" Name="UseStereo" IsEnabled="{Binding ReadyToRecord}"/>
                    <Fluent:ToggleButton Size="Middle" Header="Encode Audio" IsEnabled="{Binding ReadyToRecord}" IsChecked="True" VerticalAlignment="Center" Name="EncodeAudio"/>
                    <Slider Name="AudioQuality" IsEnabled="{Binding ReadyToRecord}"
                            IsSnapToTickEnabled="True" TickFrequency="1" SmallChange="1" LargeChange="1"
                            AutoToolTipPlacement="None" Width="100" Margin="7,0"/>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>
        </Fluent:Ribbon>

        <Fluent:StatusBar DockPanel.Dock="Bottom" Visibility="Visible">
            <Fluent:StatusBarItem HorizontalAlignment="Right">
                <this:Timer x:Name="TimeManager" VerticalContentAlignment="Center" Width="40" Foreground="White" HorizontalContentAlignment="Center"/>
            </Fluent:StatusBarItem>
            <Fluent:StatusBarItem HorizontalAlignment="Left">
                <Label Height="25" Name="Status" Content="Ready" Foreground="White" VerticalContentAlignment="Center" Background="Transparent" />
            </Fluent:StatusBarItem>
        </Fluent:StatusBar>

        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
            <ToggleButton Content="Images/Record.png" Height="60" Name="RecordButton" Command="New">
                <ToggleButton.Template>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Grid x:Name="Grid" Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}" 
                        Width="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}">
                                <Image Margin="5" x:Name="ButtonImage" Opacity="0.7"
                        Source="{Binding Content, RelativeSource={RelativeSource TemplatedParent}}" 
                        ToolTip="{TemplateBinding ToolTip}"/>
                            </StackPanel>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="ButtonImage" Property="Opacity" Value="0.8" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="true">
                                <Setter TargetName="ButtonImage" Property="Opacity" Value="1" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter TargetName="ButtonImage" Property="Opacity" Value="0.3" />
                            </Trigger>
                            <Trigger Property="IsChecked" Value="true">
                                <Setter TargetName="ButtonImage" Property="Source" Value="Images/Stop.png"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </ToggleButton.Template>
            </ToggleButton>

            <ToggleButton Content="Images/Pause.png" Height="60" Name="PauseButton" Command="this:MainWindow.PauseCommand">
                <ToggleButton.Template>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Grid x:Name="Grid" Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}" 
                                Width="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}">
                                <Image Margin="5" x:Name="ButtonImage" Opacity="0.6" 
                                       Source="{Binding Content, RelativeSource={RelativeSource TemplatedParent}}" 
                                        ToolTip="{TemplateBinding ToolTip}"/>
                            </StackPanel>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="ButtonImage" Property="Opacity" Value="0.8" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="true">
                                <Setter TargetName="ButtonImage" Property="Opacity" Value="1" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter TargetName="ButtonImage" Property="Opacity" Value="0.3" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </ToggleButton.Template>
                <ToggleButton.LayoutTransform>
                    <RotateTransform x:Name="RotationEffect" Angle="0"/>
                </ToggleButton.LayoutTransform>
            </ToggleButton>
        </StackPanel>
    </DockPanel>
</Fluent:RibbonWindow>